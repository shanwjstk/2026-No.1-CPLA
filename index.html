<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>í˜„ì¶œì—°ìŠµ ì›¹ì•± â€“ ë¯¼íŠ¸ ë¼ì´íŠ¸ í…Œë§ˆ</title>
<style>
  :root{
    /* ğŸŒ¿ ë¯¼íŠ¸/í™”ì´íŠ¸ í…Œë§ˆ */
    --bg:#ffffff;
    --panel:#ffffff;
    --line:#e2e8f0;
    --shadow:0 8px 20px rgba(0,0,0,0.05);

    --text:#0f172a;
    --muted:#64748b;

    --brand:#10b981; /* ë¯¼íŠ¸/ì—ë©”ë„ë“œ */
    --good:#16a34a;
    --bad:#dc2626;
    --warn:#f59e0b;

    --chip-bg:#f8fafc;
    --chip-line:#e2e8f0;
    --hint-bg:#f0fdf4;
    --meter-bg:#e0f2f1;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    background:var(--bg);
    color:var(--text);
    font-family:Pretendard,Apple SD Gothic Neo,system-ui,sans-serif;
  }

  h1{font-size:26px;margin:0 0 4px;font-weight:700;color:var(--brand)}
  .sub{color:var(--muted);font-size:14px;margin-bottom:20px}
  .wrap{max-width:1200px;margin:30px auto;padding:20px}
  .grid{display:grid;grid-template-columns:380px 1fr;gap:20px}

  .card{background:var(--panel);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
  .hd{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--line);background:#f9fafb;border-radius:16px 16px 0 0}
  .bd{padding:16px}

  input,textarea,select{
    width:100%;border:1px solid var(--line);border-radius:10px;padding:10px 12px;font-size:14px;
    font-family:inherit;outline:none;background:#fff;color:var(--text);
  }
  input:focus,textarea:focus,select:focus{border-color:var(--brand);box-shadow:0 0 0 2px rgba(16,185,129,.2)}
  textarea{min-height:90px;resize:vertical}

  .btn{
    border:none;border-radius:10px;padding:9px 12px;font-weight:600;font-size:14px;cursor:pointer;transition:all .1s;
  }
  .btn-primary{background:var(--brand);color:#fff}
  .btn-primary:hover{filter:brightness(1.05)}
  .btn-danger{background:var(--bad);color:#fff}
  .btn-danger:hover{filter:brightness(1.1)}
  .btn-ghost{background:var(--chip-bg);border:1px solid var(--line);color:var(--text)}
  .btn-ghost:hover{background:#f1f5f9}
  .btn-chip{border-radius:999px;padding:6px 10px;font-size:12px;background:var(--chip-bg);border:1px solid var(--chip-line)}

  .row{display:flex;gap:10px;align-items:center}
  .row>*{flex:1}
  .note{color:var(--muted);font-size:13px}
  .sep{height:1px;background:var(--line);margin:14px 0}

  .badge,.pill{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--chip-line);
    background:var(--chip-bg);border-radius:999px;padding:6px 10px;font-size:12px}
  .mini{font-size:12px}
  .right{display:flex;align-items:center;gap:8px}

  .list{max-height:420px;overflow:auto;padding-right:6px}
  .item{padding:10px;margin:8px 0;background:#fff;border:1px solid var(--line);border-radius:12px;display:flex;align-items:center;gap:8px}
  .tag{display:inline-block;border:1px solid var(--chip-line);background:var(--chip-bg);color:var(--text);border-radius:999px;padding:4px 8px;margin:3px 4px 0 0;font-size:12px}

  .hint{background:var(--hint-bg);border:1px dashed var(--line);border-radius:12px;padding:10px;margin-top:8px}

  .meter{height:14px;background:var(--meter-bg);border:1px solid var(--line);border-radius:999px;overflow:hidden}
  .fill{height:100%;background:linear-gradient(90deg,#34d399,#10b981);width:0%}

  .status{margin-top:10px;border-radius:14px;padding:12px;border:1px solid;display:flex;align-items:center;gap:10px;font-weight:700}
  .ok{background:#ecfdf5;border-color:#a7f3d0;color:#065f46}
  .ng{background:#fef2f2;border-color:#fecaca;color:#7f1d1d}
  .warn{background:#fffbeb;border-color:#fde68a;color:#7c2d12}
</style>
</head>
<body>
  <div class="wrap">
    <h1>í˜„ì¶œì—°ìŠµ ì›¹ì•±</h1>
    <div class="sub">ğŸŒ¿ ì œëª©ê³¼ ì£¼ìš” í‚¤ì›Œë“œë¡œ ì„œìˆ í˜• ëŒ€ë¹„ â€” <b style="color:var(--brand)">ë¯¼íŠ¸ í…Œë§ˆ + ë°˜ë³µí•™ìŠµ ëª¨ë“œ</b></div>

    <div class="grid">
      <!-- ì™¼ìª½ -->
      <section class="card">
        <div class="hd">
          <strong>ì„¸íŠ¸ ê´€ë¦¬</strong>
          <div class="right">
            <button class="btn-ghost" id="exportBtn">ë‚´ë³´ë‚´ê¸°</button>
            <label class="btn-ghost" for="importFile">ê°€ì ¸ì˜¤ê¸°</label>
            <input id="importFile" type="file" accept="application/json" style="display:none" />
          </div>
        </div>
        <div class="bd">
          <div class="note">í‚¤ì›Œë“œëŠ” ì‰¼í‘œ(, )ë¡œ êµ¬ë¶„. ì˜ˆ: ê³µì •ë ¥, ì²˜ë¶„ì„±, ì œì†Œê¸°ê°„</div>
          <input id="title" type="text" placeholder="ì œëª© ì…ë ¥" />
          <textarea id="keywords" placeholder="í‚¤ì›Œë“œ ì…ë ¥(ì‰¼í‘œë¡œ êµ¬ë¶„)"></textarea>
          <textarea id="refAnswer" placeholder="ì°¸ê³  ë‹µì•ˆ(ì„ íƒ)"></textarea>
          <div class="row">
            <button class="btn-primary" id="saveBtn">ì¶”ê°€/ì €ì¥</button>
            <button class="btn-danger" id="clearFormBtn">ì§€ìš°ê¸°</button>
          </div>
          <div class="sep"></div>
          <span class="badge">ì„¸íŠ¸ ëª©ë¡</span>
          <div id="list" class="list"></div>
        </div>
      </section>

      <!-- ì˜¤ë¥¸ìª½ -->
      <section class="card">
        <div class="hd">
          <strong>í˜„ì¶œ ì—°ìŠµ</strong>
          <div class="right">
            <label class="pill"><input type="checkbox" id="weakOnly"> ë°˜ë³µí•™ìŠµ(â‰¤60%)</label>
            <label class="pill"><input type="checkbox" id="hintToggle" checked> íŒíŠ¸ í‘œì‹œ</label>
          </div>
        </div>
        <div class="bd">
          <div class="row">
            <select id="deckSelect"></select>
            <button class="btn-chip" id="prevBtn">ì´ì „</button>
            <button class="btn-chip" id="nextBtn">ë‹¤ìŒ</button>
          </div>

          <div class="hint">
            <b id="qTitle">ì—°ìŠµí•  í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”.</b>
            <span class="mini muted" id="qInfo"></span>
          </div>
          <div id="hintBox" class="hint mini" style="display:none"></div>

          <textarea id="answer" placeholder="ê¸°ì–µë‚˜ëŠ” í‚¤ì›Œë“œ ì¤‘ì‹¬ìœ¼ë¡œ ê°„ë‹¨íˆ ì‘ì„±í•˜ì„¸ìš”. (Ctrl+Enterë¡œ ì±„ì )"></textarea>

          <div class="row">
            <button class="btn-primary" id="gradeBtn">ì±„ì </button>
            <button class="btn-ghost" id="showRefBtn">ì°¸ê³  ë‹µì•ˆ ë³´ê¸°</button>
          </div>

          <div class="meter"><div id="meterFill" class="fill"></div></div>
          <div id="statusBox" class="status warn" style="display:none">
            <span id="statusIcon">âš ï¸</span><span id="statusText">ì±„ì  ëŒ€ê¸° ì¤‘â€¦</span>
          </div>
          <div id="miss" class="mini"></div>
          <div id="refWrap" style="display:none;margin-top:10px">
            <div class="mini muted">ì°¸ê³  ë‹µì•ˆ</div>
            <pre id="refOut" class="mini" style="white-space:pre-wrap"></pre>
          </div>
        </div>
      </section>
    </div>
  </div>

<script>
/* ğŸ‘‡ í•µì‹¬ ê¸°ëŠ¥ (ê°„ë‹¨ ë²„ì „) */
let decks=[],idx=-1;
const s='recallDecks.v1';
function save(){localStorage.setItem(s,JSON.stringify(decks));}
function load(){try{decks=JSON.parse(localStorage.getItem(s)||'[]');}catch(e){decks=[];}}
function show(i){
  if(decks.length===0)return;
  idx=(i+decks.length)%decks.length;
  const d=decks[idx];
  qTitle.textContent=d.title;
  qInfo.textContent=`í‚¤ì›Œë“œ ${d.keywords.length}ê°œ`;
  answer.value='';meterFill.style.width='0%';
  statusBox.style.display='none';miss.innerHTML='';
  if(hintToggle.checked&&d.ref){hintBox.style.display='block';hintBox.textContent=d.ref.slice(0,150);}
  else{hintBox.style.display='none';}
  refWrap.style.display='none';
}
function grade(){
  if(idx<0)return;const d=decks[idx];
  const txt=answer.value.toLowerCase();
  const hits=d.keywords.filter(k=>txt.includes(k.toLowerCase()));
  const ratio=hits.length/d.keywords.length;
  meterFill.style.width=Math.round(ratio*100)+'%';
  statusBox.style.display='flex';
  if(ratio>=0.7){statusBox.className='status ok';statusText.textContent='ì •ë‹µ '+Math.round(ratio*100)+'%';}
  else if(ratio>0){statusBox.className='status warn';statusText.textContent='ë¶€ë¶„ì •ë‹µ '+Math.round(ratio*100)+'%';}
  else{statusBox.className='status ng';statusText.textContent='ì˜¤ë‹µ 0%';}
  const missed=d.keywords.filter(k=>!hits.includes(k));
  miss.innerHTML=missed.length?'ëˆ„ë½: '+missed.join(', '):'<span class="muted">ëˆ„ë½ ì—†ìŒ</span>';
}
document.addEventListener('DOMContentLoaded',()=>{
  load();renderList();
  if(decks.length)show(0);
  saveBtn.onclick=()=>{
    const t=title.value.trim(),ks=keywords.value.split(',').map(v=>v.trim()).filter(Boolean),r=refAnswer.value.trim();
    if(!t||!ks.length)return alert('ì œëª©/í‚¤ì›Œë“œ ì…ë ¥');
    const ex=decks.find(d=>d.title===t);
    if(ex){ex.keywords=ks;ex.ref=r;}else{decks.push({title:t,keywords:ks,ref:r});}
    save();renderList();title.value=keywords.value=refAnswer.value='';
    if(decks.length===1)show(0);
  };
  clearFormBtn.onclick=()=>{title.value=keywords.value=refAnswer.value='';};
  prevBtn.onclick=()=>show(idx-1);
  nextBtn.onclick=()=>show(idx+1);
  gradeBtn.onclick=grade;
  showRefBtn.onclick=()=>{if(idx<0)return;const d=decks[idx];if(!d.ref)return alert('ì°¸ê³  ë‹µì•ˆ ì—†ìŒ');refWrap.style.display='block';refOut.textContent=d.ref;};
  exportBtn.onclick=()=>{const name='recall-'+Date.now()+'.json';const blob=new Blob([JSON.stringify(decks,null,2)],{type:'application/json'});const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=name;a.click();};
  importFile.onchange=e=>{const f=e.target.files[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{decks=JSON.parse(r.result);save();renderList();show(0);}catch{alert('ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨');}};r.readAsText(f,'utf-8');};
});
function renderList(){
  list.innerHTML='';
  decks.forEach((d,i)=>{
    const div=document.createElement('div');
    div.className='item';
    div.innerHTML=`<div style="flex:1"><b>${d.title}</b><div>${d.keywords.join(', ')}</div></div><button class="btn-chip" onclick="show(${i})">ì—°ìŠµ</button>`;
    list.appendChild(div);
  });
}
</script>
</body>
</html>
